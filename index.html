<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Service사업부 인원별 R&R</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ✅ 버전 고정 -->
  <script defer src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/markmap-lib@0.17.3/dist/browser/index.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.3/dist/browser/index.min.js"></script>

  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      overflow: hidden;
    }
    #mindmap {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>

<body>
<svg id="mindmap"></svg>

<script>
/**
 * 1) DOM 준비
 * 2) 라이브러리 로드 확인
 * 3) 다음 프레임 2회 대기(레이아웃 안정)
 * 4) 그린 뒤 ResizeObserver로 사이즈 변경에도 fit
 */
document.addEventListener('DOMContentLoaded', () => {
  function ready(fn) {
    if (window.markmap && window.markmap.Markmap && window.markmap.Transformer) fn();
    else setTimeout(() => ready(fn), 50);
  }

  ready(() => {
    const markdown = `
# Service사업부 인원별 R&R

## 송기영 차장
### 직무
#### 서비스사업부 영업
#### 총판 / 파트너 담당

### 담당 파트너
#### 다원티에스
#### 글로웰시스템
##### SK쉴더스 협업
#### 에티버스

### 주요 R&R
#### 파트너 영업 관리
##### 파트너 영업 정책 공유
##### 파트너 영업 이슈 1차 대응
##### 파트너 요청 사항 정리 및 조율

#### 신규 파트너 발굴
##### 신규 총판/파트너 후보 발굴
##### 파트너 사업성 검토
##### 내부 검토 및 승인 요청

#### 파트너 계약 관리
##### 파트너 계약 체결 협의
##### 계약 조건 협의 및 갱신 관리
##### 계약 이행 사항 관리

### 산출물
#### 파트너 영업 현황 정리
#### 신규 파트너 검토 자료
#### 파트너 계약 관리 이력
#### 영업 협의 이력
#### 파트너 이슈 정리 자료

---

## 양리나 차장
### 직무
#### 서비스사업부 영업
#### 공급사업 담당 (제조사 관점)

### 산출물
#### 신규 서비스 론칭 제안 자료
#### 공급 계약서 및 협의 이력

---

## 김민정 사원
### 직무
#### 서비스사업부 영업지원
#### 서비스 공공 조달 담당

### 산출물
#### 사업부 매출 시트
#### 인바운드 문의 관리 리스트
`;

    const { Transformer } = window.markmap;
    const transformer = new Transformer();
    const { root } = transformer.transform(markdown);

    const svg = document.getElementById('mindmap');
    const mm = window.markmap.Markmap.create(svg, null, root);

    // 레이아웃 안정 후 fit (프레임 2회)
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        mm.fit();
      });
    });

    // 화면 크기 변경에도 항상 안정적으로 fit
    const ro = new ResizeObserver(() => mm.fit());
    ro.observe(svg);
  });
});
</script>
</body>
</html>
